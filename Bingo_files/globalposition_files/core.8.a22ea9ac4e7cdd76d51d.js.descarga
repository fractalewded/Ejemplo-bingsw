(window.agentWebpackJsonp=window.agentWebpackJsonp||[]).push([[8],{238:function(e,t,a){"use strict";var n=a(1);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(62),o=n(a(98)),r=a(300),c=(0,i.connect)(function(e){return e})((0,o.default)(r.Advert,"Advert"));t.default=c},245:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"isEmail",{enumerable:!0,get:function(){return n.isEmail}}),Object.defineProperty(t,"isNumber",{enumerable:!0,get:function(){return n.isNumber}}),Object.defineProperty(t,"isURL",{enumerable:!0,get:function(){return n.isURL}});var n=a(246)},246:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isURL=t.isNumber=t.isEmail=void 0;t.isEmail=function(e){return/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e)};t.isNumber=function(e){return/^([0-9])*$/.test(e)};t.isURL=function(e){return/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-/]))?/.test(e)}},300:function(e,t,a){"use strict";var n=a(1);Object.defineProperty(t,"__esModule",{value:!0}),t.Advert=void 0;var i=n(a(29)),o=n(a(30)),r=n(a(99)),c=n(a(60)),d=n(a(61)),l=n(a(43)),s=n(a(7)),u=n(a(5)),v=a(4),f=a(6),h=a(10),p=n(a(8)),m=a(245),g=a(31),y=a(17);function k(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var a,n=(0,l.default)(e);if(t){var i=(0,l.default)(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return(0,d.default)(this,a)}}var _=!1,b="",C=function(e){(0,c.default)(a,e);var t=k(a);function a(e){var n;return(0,i.default)(this,a),(n=t.call(this,e)).handleClick=n.handleClick.bind((0,r.default)(n)),n.handleClose=n.handleClose.bind((0,r.default)(n)),n.handleOnLoad=n.handleOnLoad.bind((0,r.default)(n)),n.handleDragStart=n.handleDragStart.bind((0,r.default)(n)),n.handleHashChange=n.handleHashChange.bind((0,r.default)(n)),n.handleMouseUp=n.handleMouseUp.bind((0,r.default)(n)),n.state={clicked:!1,showAdvert:!1},n}return(0,o.default)(a,[{key:"componentDidMount",value:function(){window.addEventListener("hashchange",this.handleHashChange),document.body&&document.body.addEventListener("mouseup",this.handleMouseUp)}},{key:"handleMouseUp",value:function(){var e=this;b=location.href;var t=function(){b!==location.href&&(b=location.href,e.handleHashChange())};setTimeout(function(){window.requestAnimationFrame?requestAnimationFrame(t):t()},500)}},{key:"componentDidUpdate",value:function(){var e=this.props.dispatch,t=p.default.getHeight,a=p.default.searchInsideShadowRoot,n=a(".".concat(f.KEY__ADVERT));function i(){var e=a(".aivochat-advert-content"),n=a(".aivochat-advert-text"),i=t(e),o=t(n);if(o<i){var r=(i-o)/2;a(".aivochat-advert-text")[0].style.top=r}}if(n.length>0){var o=this.getAd();if(o){var r=1e3*parseInt(o.delay);setTimeout(function(){n[0].classList.add("show"),_||(e((0,y.setAdvertView)(o.id)),_=!0)},r),(0,h.bringToFront)(".".concat(f.KEY__ADVERT),"2147483645"),1===parseInt(o.proactivity_type_id)&&(a(".aivochat-advert-close")[0].classList.add("aivochat-advert.show"),a(".aivochat-advert-close")[0].classList.remove("aivochat-advert.hide"),setTimeout(function(){!function(e){for(var a=parseInt(e.style.fontSize.replace("px",""));t(e)>135&&a>1;)a-=1,e.style.fontSize="".concat(a,"px"),i()}(a(".aivochat-advert-text")[0])},r))}}var c=this.getAd(),d=this.props.agentConfig.app,l=d.botId,s=d.id,u=(0,h.checkTokenForGA)(s);this.state.clicked||void 0===c||void 0===c.proactivity_type_id||!1===this.state.showAdvert&&(this.setState({showAdvert:!0}),u&&(0,g.showAdvertGoogleAnalytics)(l))}},{key:"handleClick",value:function(e){e.preventDefault();var t=this.props.dispatch,a=this.props.agentConfig,n=this.getAd(),i={id:a.user.id,type:1};t((0,y.openWindow)()),t((0,y.sendMessage)(n.question,i,a.app.id)),t((0,y.setAdvertClick)(n.id)),this.setState({clicked:!0})}},{key:"handleClose",value:function(e){e.preventDefault(),e.stopPropagation(),this.setState({clicked:!0})}},{key:"handleDragStart",value:function(e){e.preventDefault()}},{key:"handleOnLoad",value:function(e){e.preventDefault()}},{key:"handleHashChange",value:function(){this.update(),this.setState({clicked:!1})}},{key:"getAd",value:function(){var e=this.props.agentConfig;return e.proactivities?e.proactivities[0]:void 0}},{key:"update",value:function(){var e=this,t=this.props,a=t.agentConfig,n=t.dispatch;p.default.getSettings(a.app.id,function(t){t.proactivity&&t.proactivities&&(_=!1,e.setState({clicked:!1}),n((0,y.setConfig)({proactivities:t.proactivities})))})}},{key:"render",value:function(){var e=this,t=this.getAd(),a=function(a){switch(parseInt(a)){case 1:return s.default.createElement("div",{className:"aivochat-advert-content",style:{backgroundColor:t.color_background}},s.default.createElement("div",{className:"aivochat-advert-padding"},s.default.createElement("div",{className:"aivochat-advert-text",style:{color:t.color}},"".concat(t.welcome_message))),s.default.createElement("div",{className:"aivochat-advert-corner ".concat(t.image_location),style:{borderBottomColor:t.color_background}}),s.default.createElement("div",{className:"aivochat-advert-close",style:{color:t.color},onClick:e.handleClose},s.default.createElement("i",{className:"material-icons"},"close")));case 2:return s.default.createElement("div",{className:"aivochat-advert-content"},s.default.createElement("img",{className:"aivochat-advert-image",src:(0,m.isURL)(t.image_url)?t.image_url:"".concat(v.M5JGRwg,"/").concat(t.image_url),onLoad:e.handleOnLoad,onDragStart:e.handleDragStart}),s.default.createElement("div",{className:"aivochat-advert-close",style:{color:t.color},onClick:e.handleClose},s.default.createElement("i",{className:"material-icons"},"close")),s.default.createElement("div",{className:"aivochat-advert-padding"}));default:return s.default.createElement("div",null)}};return s.default.createElement("div",null,function(){if(!e.state.clicked&&void 0!==t&&void 0!==t.proactivity_type_id){var n=1===parseInt(t.proactivity_type_id)?"text":"image";return s.default.createElement("div",{className:"".concat(f.KEY__ADVERT," ").concat(n," ").concat(t.image_location),onClick:e.handleClick},a(t.proactivity_type_id))}}())}}]),a}(s.default.Component);t.Advert=C,C.propTypes={agentConfig:u.default.object,dispatch:u.default.func}}}]);